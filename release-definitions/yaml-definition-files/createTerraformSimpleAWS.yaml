---
# Defines a release definition
name: Create Terraform AWS Starter Kit Release
description: A Release Definition for creating instances of Terraform AWS Starter Kit
variables:
  - keySource: keyVault
    configFile: demoConfig.yaml
    storageAccountNameTerraformBackend: tfbkendabc123x
environments:
  - name: Dev environment
    deployPhases:
      - name: AWS Creation Job
        deploymentInput: 
        - artifactsDownloadInput:
          - alias: _terraform-aws-starter-kit
        workflowTasks: 
        - name: Python task to create AWS Infrastructure
          type: Python
          scriptPath: "$(System.DefaultWorkingDirectory)/_terraform-aws-starter-kit/drop/pipeline-tasks/createFoundation.py "
          arguments: "$(keySource)  $(configFile)  $(-aws-public-access-key)  $(-aws-secret-access-key)  $(storageAccountNameTerraformBackend)  $(demoStorageKey)  $(System.DefaultWorkingDirectory)"
        - name: Python task to Configure Jekyll
          type: Python
          scriptPath: "$(System.DefaultWorkingDirectory)/_jekyll-devserver-aws/drop/pipeline-tasks/createJekyllStuff.py "
          arguments: "$(System.DefaultWorkingDirectory) "
